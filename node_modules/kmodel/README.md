kmodel
======


### Installation

    $ alias node="node --harmony"
    $ npm install kmodel

### Quick Start
```js
var k = require("kmodel");

k.connect();// or k.connect("mongodb://ip:port", __dirname+"/models/");

```

### koa
``` js
var User = k.load("User");

router.get('/user/:id', function *() {

    var id = this.params.id;

    this.response.body = yield User.find({_id:id});
});
```
### Run Local Test 
```js
    
var test = function* (){
    
    var r = yield User.find({type:"xx"});
    console.log(r)
};

run(test);

function run (fn) {
    
    var gen = fn();
    
    next();

    function next(er, value){ 
        if (er) return gen.throw(er);
        var continuable = gen.next(value);

        if (continuable.done) return;
        var callback = continuable.value;
        callback(next);
    }
}

```

### Simple Case
```js

var User = k.create({
    username: "string",
    password: "string",
    nickname: "string"
}, "User");

var query = function *(){
    var users = yeild User.find({});
};

var user = yield User.insertOne({
    username: "aki",
    password: "aki",
    nickname: "eeee"
});
```


